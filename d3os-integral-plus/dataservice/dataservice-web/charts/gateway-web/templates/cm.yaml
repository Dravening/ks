apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "gateway-web.fullname" . }}
  labels:
    app: {{ template "gateway-web.fullname" . }}
    chart: '{{ .Chart.Name }}-{{ .Chart.Version }}'
    release: '{{ .Release.Name }}'
    heritage: '{{ .Release.Service }}'
data:
  application.yml: |-
    server:
      port: 9084
    spring:
      datasource:
        url: jdbc:mysql://mysql-dataservice.{{ .Release.Namespace }}.svc:3306/cosmo_gateway?characterEncoding=utf-8&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai
        username: d3os
        password: d3os@cosmoplat
        driver-class-name: com.mysql.cj.jdbc.Driver
      application:
        name: gateway-web
      jpa:
        hibernate:
          ddl-auto: ${db.ddl-auto:none}
        database-platform: org.hibernate.dialect.MySQL5InnoDBDialect
        show-sql: ${db.show-sql:true}
      security:
        user:
          name: admin
          password: cosmo
    eureka:
      instance:
        prefer-ip-address: true
      client:
        fetch-registry: true
        register-with-eureka: true
        registry-fetch-interval-seconds: 30
        service-url:
          defaultZone: http://eureka.{{ .Release.Namespace }}.svc:8761/eureka
    management:
      endpoints:
        web:
          exposure:
            include: "*"

    service:
      exclude: